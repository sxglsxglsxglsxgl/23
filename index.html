<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>CLASSNOE MESTO</title>
    <link rel="preconnect" href="https://fonts.cdnfonts.com" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="https://fonts.cdnfonts.com/css/sf-pro-display" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500&display=swap"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body class="is-locked theme-dark">
    <!-- FULL-WIDTH TOP BURGER BAR (starts centered & narrow, then expands to 100vw) -->
    <button
      class="burger-bar burger-bar--centered"
      type="button"
      data-menu-toggle
      aria-expanded="false"
      aria-controls="site-menu"
      aria-label="Open menu"
      data-active="0"
      tabindex="-1"
    >
      <span class="burger-bar__line"></span>
      <span class="burger-bar__line"></span>
      <span class="burger-bar__line"></span>
    </button>

    <!-- DOTS INDICATOR -->
    <nav class="dots" id="dots" aria-label="Slide navigation"></nav>

    <!-- MODAL MENU (full black overlay centered) -->
    <div
      id="site-menu"
      class="site-menu"
      role="dialog"
      aria-modal="true"
      aria-label="Site navigation"
      aria-hidden="true"
      hidden
    >
      <div class="site-menu__backdrop" data-menu-close></div>
      <div class="site-menu__container" role="document" tabindex="-1" data-menu-focus>
        <ul class="site-menu__list" role="list">
          <li class="site-menu__item"><a href="#about" class="site-menu__link" data-menu-link>ABOUT</a></li>
          <li class="site-menu__item"><a href="#projects" class="site-menu__link" data-menu-link>PROJECTS</a></li>
          <li class="site-menu__item"><a href="#menu-coffee" class="site-menu__link" data-menu-link>COFFEE</a></li>
          <li class="site-menu__item"><a href="#contacts" class="site-menu__link" data-menu-link>CONTACT</a></li>
        </ul>
      </div>
    </div>

    <!-- SITE CONTENT: Track-based fullpage slides -->
    <main class="slides" id="slides" aria-label="Slides">
      <div class="slides__track" id="track">
        <section class="slide hero is-visible" id="hero" aria-label="Hero">
          <div class="hero__center">
            <h1 class="hero__title">CLASSNOE MESTO</h1>
            <div id="heroSub" class="hero__sub" aria-live="polite" aria-label="Based in St. Petersburg"></div>
          </div>
        </section>

        <section class="slide reveal" id="about" aria-label="About">
          <div class="container">
            <h2>WHO WE ARE</h2>
            <p>
              We’re a creative collective shaping a culture where training, taste, and aesthetics are
              part of everyday life. Health as identity. Energy as a habit. Design as a daily practice.
            </p>
          </div>
        </section>

        <section class="slide reveal" id="projects" aria-label="Projects">
          <div class="container">
            <h2>PROJECTS</h2>
            <p>Coming soon.</p>
          </div>
        </section>

        <section class="slide reveal" id="menu-coffee" aria-label="Coffee">
          <div class="container">
            <h2>COFFEE</h2>
            <p>Concept menu and signature drinks in progress.</p>
          </div>
        </section>

        <section class="slide reveal" id="contacts" aria-label="Contacts">
          <div class="container">
            <h2>CONTACT</h2>
            <p>hello@classnoe.mesto — Instagram / Telegram</p>
          </div>
        </section>
      </div>
    </main>

    <!-- Controller for menu (same logic) -->
    <script>
      (function () {
        const menu = document.getElementById('site-menu');
        const toggleBtn = document.querySelector('[data-menu-toggle]');
        const backdrop = menu?.querySelector('[data-menu-close]');
        const focusHost = menu?.querySelector('[data-menu-focus]');
        const links = [...(menu?.querySelectorAll('[data-menu-link]') || [])];
        const OPEN_CLASS = 'has-menu-open';
        const CLOSING_CLASS = 'is-menu-closing';
        const CLOSE_ANIM_MS = 480;

        if (!menu || !toggleBtn) return;

        let lastFocusedEl = null;

        function setAria(isOpen) {
          toggleBtn.setAttribute('aria-expanded', String(isOpen));
          menu.setAttribute('aria-hidden', String(!isOpen));
          if (!isOpen) menu.setAttribute('hidden', '');
          else menu.removeAttribute('hidden');
        }

        function trapFocus(e) {
          if (e.key !== 'Tab') return;
          const focusables = menu.querySelectorAll(
            'a[href], button:not([disabled]), [tabindex]:not([tabindex="-1"])'
          );
          if (!focusables.length) return;
          const first = focusables[0];
          const last = focusables[focusables.length - 1];
          if (e.shiftKey && document.activeElement === first) {
            last.focus();
            e.preventDefault();
          } else if (!e.shiftKey && document.activeElement === last) {
            first.focus();
            e.preventDefault();
          }
        }

        function onKeydown(e) {
          if (e.key === 'Escape') {
            closeMenu();
          } else if (e.key === 'Tab') {
            trapFocus(e);
          }
        }

        function openMenu() {
          lastFocusedEl = document.activeElement;
          document.body.classList.add(OPEN_CLASS);
          menu.classList.add('is-open');
          setAria(true);
          document.addEventListener('keydown', onKeydown);
          (focusHost || menu).focus({ preventScroll: true });
        }

        function closeMenu() {
          document.body.classList.add(CLOSING_CLASS);
          document.body.classList.remove(OPEN_CLASS);
          setAria(false);
          document.removeEventListener('keydown', onKeydown);
          window.setTimeout(() => {
            document.body.classList.remove(CLOSING_CLASS);
            menu.classList.remove('is-open');
            if (lastFocusedEl && lastFocusedEl.focus) {
              lastFocusedEl.focus({ preventScroll: true });
            }
          }, CLOSE_ANIM_MS);
        }

        document.addEventListener('click', (e) => {
          const t = e.target;
          if (!(t instanceof Element)) return;
          if (t.closest('[data-menu-toggle]')) {
            const isOpen = document.body.classList.contains(OPEN_CLASS);
            isOpen ? closeMenu() : openMenu();
          }
        });

        backdrop?.addEventListener('click', closeMenu);
        links.forEach((a) => a.addEventListener('click', closeMenu));

        menu.addEventListener('click', (e) => {
          const container = menu.querySelector('.site-menu__container');
          if (container && !container.contains(e.target)) closeMenu();
        });
      })();
    </script>

    <!-- Intro + fullpage track nav + dots -->
    <script src="script.js"></script>
  </body>
</html>
